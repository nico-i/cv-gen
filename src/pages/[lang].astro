---
import "@/styles/globals.css";

import Profile from "@/components/sections/Profile.astro";
import Experience from "@/components/sections/Experience.astro";
import Interests from "@/components/sections/Interests.astro";
import Education from "@/components/sections/Education.astro";
import Skills from "@/components/sections/Skills.astro";
import Languages from "@/components/sections/Languages.astro";
import VolunteerWork from "@/components/sections/VolunteerWork.astro";
import Projects from "@/components/sections/Projects.astro";
import Certificates from "@/components/sections/Certificates.astro";

import { type GetStaticPaths } from "astro";

import { Locale } from "@/lib/types/Locale";
import { useTranslation } from "@/lib/i18n/utils";

export const getStaticPaths = (async () => {
  const paths = Object.values(Locale).map((locale) => {
    return { params: { lang: locale, slug: `/${locale}/` } };
  });

  return paths;
}) satisfies GetStaticPaths;

const { lang } = Astro.params;
const { t } = useTranslation(lang);
---

<html lang={lang}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <meta name="description" content={t("meta-description")} />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5" />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="theme-color" content="#ffffff" />

    <title>CV | Nico Ismaili</title>
  </head>
  <body
    class="w-full
    lg:w-[215.9mm]
    h-full
    mx-auto
    p-1.5
    grid gap-1.5 grid-cols-1 lg:grid-cols-[34%,auto] auto-cols-min"
  >
    <div class="hidden lg:flex lg:flex-col lg:gap-1.5">
      <Profile locale={lang} />
      <Skills locale={lang} />
      <Languages locale={lang} />
      <Interests locale={lang} />
    </div>
    <div class="hidden lg:flex lg:flex-col lg:gap-1.5">
      <Experience locale={lang} />
      <Education locale={lang} />
      <Projects locale={lang} />
      <Certificates locale={lang} />
      <VolunteerWork locale={lang} />
    </div>

    <div class="lg:hidden flex flex-col gap-1.5">
      <Profile locale={lang} />
      <Experience locale={lang} />
      <Skills locale={lang} />
      <Education locale={lang} />
      <Projects locale={lang} />
      <Certificates locale={lang} />
      <Languages locale={lang} />
      <VolunteerWork locale={lang} />
      <Interests locale={lang} />
    </div>
  </body>

  <!-- Auto Theme Switcher Script -->
  <script is:inline>
    const getThemePreference = () => {
      if (
        typeof localStorage !== "undefined" &&
        localStorage.getItem("theme")
      ) {
        return localStorage.getItem("theme");
      }
      return window.matchMedia("(prefers-color-scheme: dark)").matches
        ? "dark"
        : "light";
    };
    const isDark = getThemePreference() === "dark";
    document.documentElement.classList[isDark ? "add" : "remove"]("dark");

    if (typeof localStorage !== "undefined") {
      const observer = new MutationObserver(() => {
        const isDark = document.documentElement.classList.contains("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
      });
      observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ["class"],
      });
    }
  </script>
</html>
